/**
* @version: 1.0.1
* @author: Dan Grossman http://www.dangrossman.info/
* @date: 2012-08-20
* @copyright: Copyright (c) 2012 Dan Grossman. All rights reserved.
* @license: Licensed under Apache License v2.0. See http://www.apache.org/licenses/LICENSE-2.0
* @website: http://www.improvely.com/
* Modified by ERDIL
*/!function(e){function t(e,t){return e<t?!1:e>t?!1:!0}var n=function(t,n,r){var i=typeof n=="object",s;this.startDate=moment().startOf("day");this.endDate=moment().startOf("day");this.currentDate=moment().startOf("day");this.calendarMinViewMode="days";this.calendarStartView="month";this.quarterlyView=!1;this.weeklyView=!1;this.minDate=moment("01-01-2001","MM-DD-YYYY");this.maxDate=!1;this.changed=!1;this.customRangeChoice=!0;this.ranges={};this.defaultRange="";this.separators=[];this.opens="right";this.opensV="bottom";this.cb=function(){};this.format="MM/DD/YYYY";this.separator=" - ";this.showWeekNumbers=!1;this.locale={customRangeLabel:"Custom Range",daysOfWeek:moment().lang().weekdaysMin,monthNames:moment().lang().months,firstDay:0};s=this.locale;this.parentEl="body";this.element=e(t);this.element.hasClass("pull-right")&&(this.opens="left");this.element.is("input")?this.element.on({click:e.proxy(this.show,this),focus:e.proxy(this.show,this)}):this.element.on("click",e.proxy(this.show,this));i&&typeof n.locale=="object"&&e.each(s,function(e,t){s[e]=n.locale[e]||t});i&&typeof n.customRangeChoice!="undefined"&&!n.customRangeChoice&&(this.customRangeChoice=!1);this.parentEl=i&&n.parentEl&&e(n.parentEl)||e(this.parentEl);var o='<div class="daterangepicker dropdown-menu"><div class="ranges"></div></div>',u=this.parentEl.attr("id")+"-calendar-start",a=this.parentEl.attr("id")+"-calendar-end",f='<div class="daterangepicker-popover"><div class="calendars"><table class="calendars-table table"><thead><tr><th>DÃ©but</th><th>Fin</th></tr></thead><tbody><tr><td><div id="'+u+'" class="calendar-start"></div></td>'+'<td><div id="'+a+'" class="calendar-end"></div></td>'+"</tr>"+"</tbody>"+"</table>"+"</div>"+'<div class="separator"></div>'+"<div>"+'<button class="btn btn-main submit">Valider</button>'+'<button class="btn cancel">Annuler</button>'+"</div>";"</div>";this.container=e(o).appendTo(this.parentEl);this.$customRangeContainer=e(f).appendTo(this.parentEl);this.$calendarStart=e("#"+u);this.$calendarEnd=e("#"+a);if(i){typeof n.format=="string"&&(this.format=n.format);typeof n.separator=="string"&&(this.separator=n.separator);typeof n.startDate=="object"&&(this.startDate=n.startDate);typeof n.endDate=="object"&&(this.endDate=n.endDate);typeof n.minDate=="object"&&(this.minDate=n.minDate);typeof n.maxDate=="object"&&(this.maxDate=n.maxDate);typeof n.currentDate=="object"&&(this.currentDate=n.currentDate);Object.prototype.toString.apply(n.separators)==="[object Array]"&&(this.separators=n.separators);typeof n.calendarMinViewMode=="string"&&(this.calendarMinViewMode=n.calendarMinViewMode);typeof n.calendarStartView=="string"&&(this.calendarStartView=n.calendarStartView);typeof n.quarterlyView=="boolean"&&(this.quarterlyView=n.quarterlyView);typeof n.weeklyView=="boolean"&&(this.weeklyView=n.weeklyView);typeof n.defaultRange=="string"&&(this.defaultRange=n.defaultRange);typeof n.opensV=="string"&&(this.opensV=n.opensV);if(typeof n.ranges=="object"){for(var l in n.ranges){var c=n.ranges[l][0],h=n.ranges[l][1];typeof c=="string"&&(c=moment(c));typeof h=="string"&&(h=moment(h));this.minDate&&c<this.minDate&&(c=this.minDate);this.maxDate&&h>this.maxDate&&(h=this.maxDate);if(this.minDate&&h<this.minDate||this.maxDate&&c>this.maxDate)continue;this.ranges[l]=[moment(c).startOf("day"),moment(h).startOf("day")]}var p="<ul>",d=0;if(this.opensV==="top"&&this.customRangeChoice){p+='<li class="range custom-range"><span class="checkmark"></span>'+this.locale.customRangeLabel+"</li>";p+='<li class="range divider"></li>'}_.each(this.ranges,function(e,t){_.contains(this.separators,d)&&(p+='<li class="range divider"></li>');var n="";if(t===this.defaultRange){n=" active";this.startDate=e[0];this.endDate=e[1]}p+='<li class="range"><span class="checkmark'+n+'"></span>'+t+'<span class="date-description">'+e[0].format("L")+" - "+e[1].format("L")+"</span></li>";d+=1},this);if(this.opensV==="bottom"&&this.customRangeChoice){p+='<li class="range divider"></li>';p+='<li class="range custom-range"><span class="checkmark"></span>'+this.locale.customRangeLabel+"</li>"}p+="</ul>";this.container.find(".ranges").prepend(p)}if(typeof n.locale=="object"&&typeof n.locale.firstDay=="number"){this.locale.firstDay=n.locale.firstDay;var v=n.locale.firstDay;while(v>0){this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());v--}}typeof n.opens=="string"&&(this.opens=n.opens)}typeof r=="function"&&(this.cb=r);this.container.addClass("opens"+this.opensV+this.opens);this.$customRangeContainer.addClass("opens"+this.opensV+this.opens);this.container.find(".ranges").on("mousedown","li.range",e.proxy(this.mousedown,this));this.container.find(".ranges").on("click","li.range",e.proxy(this.clickRange,this));this.$customRangeContainer.on("click","button.cancel",e.proxy(this.cancelCustomRangePopover,this));this.$customRangeContainer.on("click","button.submit",e.proxy(this.submitCustomRangePopover,this));this.createCalendars();this.$customRangeContainer.hide()};n.prototype={constructor:n,mousedown:function(e){e.stopPropagation();e.preventDefault()},notify:function(){this.$calendarStart.datepicker("update",this.startDate.format("MM/DD/YYYY"));this.$calendarEnd.datepicker("update",this.endDate.format("MM/DD/YYYY"));this.cb(this.startDate,this.endDate)},move:function(e){var t={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},n=0;this.opensV=="bottom"?n=this.parentEl.height:n=0-e.outerHeight();this.opens=="left"?e.css({top:n,right:0,left:"auto"}):e.css({top:n,left:this.parentEl.width()-e.outerWidth(),right:"auto"})},show:function(t){this.container.show();this.move(this.container);if(t){t.stopPropagation();t.preventDefault()}this.changed=!1;e(document).on("mousedown",e.proxy(this.hide,this))},hide:function(t){this.container.hide();e(document).off("mousedown",this.hide);if(this.changed){this.changed=!1;this.notify()}},clickRange:function(t){$target=e(t.target);$target.is("span")&&($target=$target.parent());if($target.hasClass("custom-range")){this.hide();this.$customRangeContainer.show();this.move(this.$customRangeContainer);e(document).on("mousedown",e.proxy(this.clickOutsideCustomRangePopover,this));t.preventDefault();return!1}var n=$target.justtext();this.container.find("div.ranges li span.checkmark").removeClass("active");$target.find("span.checkmark").addClass("active");var r=this.ranges[n];this.startDate=r[0];this.endDate=r[1];this.changed=!0;this.hide()},cancelCustomRangePopover:function(e){this.$customRangeContainer.hide()},clickOutsideCustomRangePopover:function(t){e(t.target).closest(".daterangepicker-popover").length==0&&this.$customRangeContainer.hide()},submitCustomRangePopover:function(e){this.startDate=moment(this.$calendarStart.data("datepicker").getDate());this.endDate=moment(this.$calendarEnd.data("datepicker").getDate());this.container.find("div.ranges li span.checkmark").removeClass("active");this.container.find("li.custom-range span.checkmark").addClass("active");this.notify();this.$customRangeContainer.hide()},createCalendars:function(){this.$calendarStart.datepicker({format:"mm/dd/yyyy",weekStart:1,language:"fr",startDate:this.minDate.format("MM/DD/YYYY"),endDate:this.currentDate.subtract("days",1).format("MM/DD/YYYY"),minViewMode:this.calendarMinViewMode,quarterlyView:this.quarterlyView,weeklyView:this.weeklyView,startView:this.calendarStartView,todayHighlight:!0,todayBtn:!0});this.$calendarEnd.datepicker({format:"mm/dd/yyyy",weekStart:1,language:"fr",startDate:this.currentDate.add("days",1).format("MM/DD/YYYY"),minViewMode:this.calendarMinViewMode,quarterlyView:this.quarterlyView,weeklyView:this.weeklyView,startView:this.calendarStartView,todayHighlight:!0,todayBtn:!0});this.$calendarStart.datepicker("update",this.startDate.format("MM/DD/YYYY"));this.$calendarEnd.datepicker("update",this.endDate.format("MM/DD/YYYY"))}};e.fn.daterangepicker=function(t,r){this.each(function(){var i=e(this);i.data("daterangepicker")||i.data("daterangepicker",new n(i,t,r))});return this};e.fn.justtext=function(){return e(this).clone().children().remove().end().text()}}(window.jQuery);